<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<title>史记·高祖本纪 - 深色版</title>
<style>
  body { 
    font-family: "宋体", serif; 
    line-height: 1.8;
    font-size: 1.8em;
    background-color: #222;
    color: #ddd;
    padding: 20px;
  }
  .text { 
    max-width: 900px; 
    margin: 0 auto;
    padding: 20px;
    background-color: #333;
    border-radius: 8px;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
  }
  .annotation-btn {
    display: inline-block;
    background: #444;
    border: 1px solid #666;
    border-radius: 3px;
    padding: 0 4px;
    margin: 0 2px;
    cursor: pointer;
    font-size: 0.6em;
    color: #55aaff;
    vertical-align: middle;
  }
  .annotation-group {
    display: inline-flex;
    flex-wrap: nowrap;
    vertical-align: middle;
  }
  /* 弹窗样式 */
  #overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }
  #popup {
    background: #444;
    max-width: 700px;
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.8);
    position: absolute;
    font-size: 0.7em;
    line-height: 1.6;
    color: #eee;
    border: 1px solid #666;
    cursor: move;
  }
  #popup-title {
    font-weight: bold;
    margin-bottom: 10px;
    color: #55aaff;
    border-bottom: 1px solid #666;
    padding-bottom: 5px;
  }
  #popup .close-btn {
    position: absolute;
    top: 10px; right: 15px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #999;
  }
  #popup .close-btn:hover {
    color: #ddd;
  }
  h1 {
    text-align: center;
    color: #f8f8f8;
    margin-bottom: 30px;
    border-bottom: 2px solid #555;
    padding-bottom: 10px;
  }
  ruby {
    ruby-position: under;
  }
  rt {
    font-size: 0.5em;
    color: #aaa;
  }
</style>
</head>
<body>
<div class="text">
<h1>卷八 高祖本纪第八</h1>

<p>四年，项羽乃谓海春侯大司马曹咎曰：「谨守成皋。若汉挑战，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="挑，田吊反。下同。">【正义】</span>
</span>慎勿与战，无令得东而已。我十五日必定梁地，复从将军。」乃行击陈留、外黄、睢阳，下之。汉果数挑楚军，楚军不出，使人辱之五六日，大司马怒，度兵汜水。<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="汜音祀，在成皋故城东。">【正义】</span>
</span>士卒半渡，汉击之，大破楚军，尽得楚国金玉货赂。大司马咎、长史欣皆自刭汜水上。项羽至睢阳，闻海春侯破，乃引兵还。汉军方围钟离眛于荥阳东，项羽至，尽走险阻。</p>

<p>韩信已破齐，使人言曰：「齐边楚，<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="文颖曰：「边，近也。」">【集解】</span>
</span>权轻，不为假王，恐不能安齐。」汉王欲攻之。留侯曰：「不如因而立之，使自为守。」乃遣张良操印绶立韩信为齐王。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「三月。」">【集解】</span>
</span></p>

<p>项羽闻龙且军破，则恐，使盱台人武涉往说韩信。韩信不听。</p>

<p>楚汉久相持未决，丁壮苦军旅，老弱罢转饟。汉王项羽相与临广武之间而语。项羽欲与汉王独身挑战。汉王数项羽曰：「始与项羽俱受命怀王，曰先入定关中者王之，项羽负约，<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="负音佩也。">【索隐】</span>
</span>王我于蜀汉，罪一。秦项羽矫杀卿子冠军而自尊，罪二。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「卿，一作『庆』。」">【集解】</span>
  <span class="annotation-btn" data-type="索隐" data-content="韦昭云：「宋义之号。」如淳曰：「卿者，大夫之尊；子者，子男之爵；冠军，人之首也。尊宋义，故加此号。」">【索隐】</span>
</span>项羽已救赵，当还报，而擅劫诸侯兵入关，罪三。怀王约入秦无暴掠，项羽烧秦宫室，掘始皇帝冢，私收其财物，罪四。又彊杀秦降王子婴，罪五。诈坑秦子弟新安二十万，王其将，罪六。项羽皆王诸将善地，<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="谓章邯等。">【索隐】</span>
</span>而徙逐故主，<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="谓田市、赵歇、韩广之属。">【索隐】</span>
</span>令臣下争叛逆，罪七。项羽出逐义帝彭城，自都之，夺韩王地，并王梁楚，多自予，罪八。项羽使人阴弑义帝江南，罪九。夫为人臣而弑其主，杀已降，为政不平，主约不信，天下所不容，大逆无道，罪十也。吾以义兵从诸侯诛残贼，使刑馀罪人击杀项羽，何苦乃与公挑战！」项羽大怒，伏弩射中汉王。汉王伤匈，乃扪足<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="扪，摸也。中匈而扪足者，盖以矢初中痛闷，不知所在故尔。或者中匈而扪足，权以安士卒之心也。">【索隐】</span>
</span>曰：「虏中吾指！」汉王病创卧，张良彊请汉王起行劳军，以安士卒，毋令楚乘胜于汉。汉王出行军，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="行，寒孟反。">【正义】</span>
</span>病甚，<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="按：三辅故事曰「楚汉相距于京索间六年，身被大创十二，矢石通中过者有四」。言汉王病创也。">【索隐】</span>
</span>因驰入成皋。</p>

<p>病瘉，西入关，至栎阳，存问父老，置酒，枭故塞王欣头栎阳市。<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="枭，县首于木也。欣自刭于汜水上，令枭之于栎阳者，以旧都，故枭以示之也。">【索隐】</span>
</span>留四日，复如军，军广武。关中兵益出。</p>

<p>当此时，彭越将兵居梁地，往来苦楚兵，绝其粮食。田横往从之。项羽数击彭越等，齐王信又进击楚。项羽恐，乃与汉王约，中分天下，割鸿沟而西者为汉，鸿沟而东者为楚。<span class="annotation-group">
  <span class="annotation-btn" data-type="索隐" data-content="应劭云：「在荥阳东南三十里，盖引河东南入淮泗也。」张华云：「一渠东南流，经浚仪，是始皇所凿，引河灌大梁，谓之鸿沟。一渠东经阳武南，为官渡水。」北征记云中牟台下临汴水，是为官渡水也。">【索隐】</span>
</span>项王归汉王父母妻子，军中皆呼万岁，乃归而别去。</p>

<p>项羽解而东归。汉王欲引而西归，用留侯、陈平计，乃进兵追项羽，至阳夏南止军，与齐王信、建成侯彭越期会而击楚军。至固陵，不会。楚击汉军，大破之。汉王复入壁，深堑而守之。用张良计，于是韩信、彭越皆往。及刘贾入楚地，围寿春，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="今寿州。">【正义】</span>
</span>汉王败固陵，<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="晋灼曰：「即固始。」">【集解】</span>
</span>乃使使者召大司马周殷举九江兵而迎<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「周殷以兵随刘贾。」">【集解】</span>
</span>武王，行屠城父，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="父音甫，今亳州县。">【正义】</span>
</span>随刘贾、齐梁诸侯皆大会垓下。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「七月。」">【集解】</span>
</span>立武王布为淮南王。</p>

</div>

<!-- 弹窗 -->
<div id="overlay">
  <div id="popup">
    <span class="close-btn" title="关闭">×</span>
    <div id="popup-title"></div>
    <div id="popup-content"></div>
  </div>
</div>

<script>
  // 获取所有注解按钮
  const buttons = document.querySelectorAll('.annotation-btn');
  const overlay = document.getElementById('overlay');
  const popup = document.getElementById('popup');
  const popupTitle = document.getElementById('popup-title');
  const popupContent = document.getElementById('popup-content');
  const closeBtn = popup.querySelector('.close-btn');

  // 拖拽功能变量
  let isDragging = false;
  let offsetX, offsetY;

  // 开始拖拽
  popup.addEventListener('mousedown', (e) => {
    if (e.target === closeBtn) return;
    isDragging = true;
    offsetX = e.clientX - popup.getBoundingClientRect().left;
    offsetY = e.clientY - popup.getBoundingClientRect().top;
    popup.style.cursor = 'grabbing';
  });

  // 拖拽中
  document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    popup.style.left = (e.clientX - offsetX) + 'px';
    popup.style.top = (e.clientY - offsetY) + 'px';
    popup.style.transform = 'none'; // 移除居中定位
  });

  // 结束拖拽
  document.addEventListener('mouseup', () => {
    isDragging = false;
    popup.style.cursor = 'move';
  });

  buttons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const type = btn.getAttribute('data-type');
      const content = btn.getAttribute('data-content');
      popupTitle.textContent = type;
      popupContent.innerHTML = content.replace(/\n/g, '<br>');
      
      // 显示弹窗
      overlay.style.display = 'flex';
      
      // 初始居中定位
      popup.style.left = '50%';
      popup.style.top = '50%';
      popup.style.transform = 'translate(-50%, -50%)';
      
      e.stopPropagation();
    });
  });

  closeBtn.addEventListener('click', () => {
    overlay.style.display = 'none';
  });

  // 点击遮罩层关闭弹窗
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) {
      overlay.style.display = 'none';
    }
  });
</script>

</body>
</html>