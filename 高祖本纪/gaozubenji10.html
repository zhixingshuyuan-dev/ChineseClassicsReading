<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<title>史记·高祖本纪 - 深色版</title>
<style>
  body { 
    font-family: "宋体", serif; 
    line-height: 1.8;
    font-size: 1.8em;
    background-color: #222;
    color: #ddd;
    padding: 20px;
  }
  .text { 
    max-width: 900px; 
    margin: 0 auto;
    padding: 20px;
    background-color: #333;
    border-radius: 8px;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
  }
  .annotation-btn {
    display: inline-block;
    background: #444;
    border: 1px solid #666;
    border-radius: 3px;
    padding: 0 4px;
    margin: 0 2px;
    cursor: pointer;
    font-size: 0.6em;
    color: #55aaff;
    vertical-align: middle;
  }
  .annotation-group {
    display: inline-flex;
    flex-wrap: nowrap;
    vertical-align: middle;
  }
  /* 弹窗样式 */
  #overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }
  #popup {
    background: #444;
    max-width: 700px;
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(0,0,0,0.8);
    position: absolute;
    font-size: 0.7em;
    line-height: 1.6;
    color: #eee;
    border: 1px solid #666;
    cursor: move;
  }
  #popup-title {
    font-weight: bold;
    margin-bottom: 10px;
    color: #55aaff;
    border-bottom: 1px solid #666;
    padding-bottom: 5px;
  }
  #popup .close-btn {
    position: absolute;
    top: 10px; right: 15px;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    color: #999;
  }
  #popup .close-btn:hover {
    color: #ddd;
  }
  h1 {
    text-align: center;
    color: #f8f8f8;
    margin-bottom: 30px;
    border-bottom: 2px solid #555;
    padding-bottom: 10px;
  }
  ruby {
    ruby-position: under;
  }
  rt {
    font-size: 0.5em;
    color: #aaa;
  }
</style>
</head>
<body>
<div class="text">
<h1>卷八 高祖本纪第八</h1>

<p>二年，汉王东略地，塞王欣、翟王翳、河南王申阳皆降。韩王昌不听，使韩信击破之。于是置陇西、北地、上郡、渭南、<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「后曰京兆。」">【集解】</span>
</span>河上、<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「冯翊。」">【集解】</span>
</span>中地郡；<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「扶风。」">【集解】</span>
</span>关外置河南郡。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「十月，汉王至陕。」">【集解】</span>
</span>更立韩太尉信为韩王。诸将以万人若以一郡降者，封万户。缮治河上塞。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="晋灼曰：「晁错传秦时北攻胡，筑河上塞。」">【集解】</span>
</span>诸故秦苑囿园池，皆令人得田之，正月，虏雍王弟章平。大赦罪人。</p>

<p>汉王之出关至陕，抚关外父老，还，张耳来见，汉王厚遇之。</p>

<p>二月，令除秦社稷，更立汉社稷。</p>

<p>三月，汉王从临晋渡，魏王豹将兵从。下河内，虏殷王，置河内郡。南渡平阴津，至雒阳。新城<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="括地志云：「洛州伊阙县在州南七十里，本汉新城也。隋文帝改新城为伊阙，取伊阙山为名也。」">【正义】</span>
</span>三老董公遮说汉王<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="百官表云：「十里一亭，亭有长。十亭一乡，乡有三老，三老掌教化。」皆秦制也。又乐产云：「横道自言曰遮。」楚汉春秋云：「董公八十二，遂封为成侯。」">【正义】</span>
</span>以义帝死故。汉王闻之，袒而大哭。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="如淳曰：「袒亦如礼袒踊。」">【集解】</span>
</span>遂为义帝发丧，临三日。发使者告诸侯曰：「天下共立义帝，北面事之。今项羽放杀义帝于江南，大逆无道。寡人亲为发丧，诸侯皆缟素。悉发关内兵，收三河士，<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="韦昭曰：「河南、河东、河内。」">【集解】</span>
</span>南浮江汉以下，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="南收三河士，发关内兵，从雍州入子午道，至汉中，历汉水而下，从是东行，至徐州，击楚。愿从诸侯王击楚之杀义帝者。」">【正义】</span>
</span></p>

<p>是时项王北击齐，田荣与战城阳。田荣败，走平愿，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="德州平愿县是。平愿民杀之。齐皆降楚。楚因焚烧其城郭，系虏其子女。齐人叛之。田荣弟横立荣子广为齐王，齐王反楚城阳。">【正义】</span>
</span>项羽虽闻汉东，既已连齐兵，欲遂破之而击汉。汉王以故得劫五诸侯兵，遂入彭城。项羽闻之，乃引兵去齐，从鲁<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="兖州曲阜也。">【正义】</span>
</span>出胡陵，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="地理志云胡陵在山阳郡。">【正义】</span>
</span>至萧，<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="徐州萧县。">【正义】</span>
</span>与汉大战彭城灵壁东<span class="annotation-group">
  <span class="annotation-btn" data-type="正义" data-content="在徐州符离县西北九十里。">【正义】</span>
</span>睢水上，大破汉军，多杀士卒，睢水为之不流。乃取汉王父母妻子于沛，置之军中以为质。当是时，诸侯见楚彊汉败，还皆去汉复为楚。塞王欣亡入楚。</p>

<p>吕后兄周吕侯为汉将兵，居下邑。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「在梁。」">【集解】</span>
</span>汉王从之，稍收士卒，军砀。汉王乃西过梁地，至虞。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="徐广曰：「在梁。」">【集解】</span>
</span>使谒者随何之九江王布所，曰：「公能令布举兵叛楚，项羽必留击之。得留数月，吾取天下必矣。」随何往说九江王布，布果背楚。楚使龙且往击之。</p>

<p>王之败彭城而西，行使人求家室，家室亦亡，不相得。败后乃独得孝惠，六月，立为太子，大赦罪人。令太子守栎阳，诸侯子在关中者皆集栎阳为卫。引水灌废丘，废丘降，章邯自杀。更名废丘为槐里。于是令祠官祀天地四方上帝山川，以时祀之。兴关内卒乘塞。<span class="annotation-group">
  <span class="annotation-btn" data-type="集解" data-content="李奇曰：「乘，守也。」">【集解】</span>
</span></p>

<p>时九江王布与龙且战，不胜，与随何间行归汉。汉王稍收士卒，与诸将及关中卒益出，是以兵大振荥阳，破楚京、索间。</p>

</div>

<!-- 弹窗 -->
<div id="overlay">
  <div id="popup">
    <span class="close-btn" title="关闭">×</span>
    <div id="popup-title"></div>
    <div id="popup-content"></div>
  </div>
</div>

<script>
  // 获取所有注解按钮
  const buttons = document.querySelectorAll('.annotation-btn');
  const overlay = document.getElementById('overlay');
  const popup = document.getElementById('popup');
  const popupTitle = document.getElementById('popup-title');
  const popupContent = document.getElementById('popup-content');
  const closeBtn = popup.querySelector('.close-btn');

  // 拖拽功能变量
  let isDragging = false;
  let offsetX, offsetY;

  // 开始拖拽
  popup.addEventListener('mousedown', (e) => {
    if (e.target === closeBtn) return;
    isDragging = true;
    offsetX = e.clientX - popup.getBoundingClientRect().left;
    offsetY = e.clientY - popup.getBoundingClientRect().top;
    popup.style.cursor = 'grabbing';
  });

  // 拖拽中
  document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    popup.style.left = (e.clientX - offsetX) + 'px';
    popup.style.top = (e.clientY - offsetY) + 'px';
    popup.style.transform = 'none'; // 移除居中定位
  });

  // 结束拖拽
  document.addEventListener('mouseup', () => {
    isDragging = false;
    popup.style.cursor = 'move';
  });

  buttons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const type = btn.getAttribute('data-type');
      const content = btn.getAttribute('data-content');
      popupTitle.textContent = type;
      popupContent.innerHTML = content.replace(/\n/g, '<br>');
      
      // 显示弹窗
      overlay.style.display = 'flex';
      
      // 初始居中定位
      popup.style.left = '50%';
      popup.style.top = '50%';
      popup.style.transform = 'translate(-50%, -50%)';
      
      e.stopPropagation();
    });
  });

  closeBtn.addEventListener('click', () => {
    overlay.style.display = 'none';
  });

  // 点击遮罩层关闭弹窗
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) {
      overlay.style.display = 'none';
    }
  });
</script>

</body>
</html>