<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>论语解读 - 道千乘之国</title>
    <style>
        body {
            font-family: "楷体", KaiTi, "STKaiti", serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #e2e8f0;
            background-color: #1a202c;
        }
        h1 {
            font-family: "黑体", SimHei, sans-serif;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 30px;
            color: #fbd38d;
        }
        .main-text {
            font-size: 22px;
            text-align: center;
            margin: 40px 0;
            line-height: 2;
            padding: 20px;
            background-color: #2d3748;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #4a5568;
        }
        .char-container {
            display: inline-block;
            cursor: pointer;
            margin: 0 1px;
            position: relative;
            vertical-align: top;
        }
        .char-pinyin {
            display: none;
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #fbd38d;
            color: #1a202c;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .char-english {
            display: none;
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #fbd38d;
            color: #1a202c;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .char-pinyin:after, .char-english:after {
            content: "";
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            border-width: 5px 5px 0;
            border-style: solid;
            border-color: #fbd38d transparent transparent;
        }
        .char-pinyin:after {
            bottom: -5px;
        }
        .char-english:after {
            top: -5px;
            border-width: 0 5px 5px;
            border-color: transparent transparent #fbd38d;
        }
        .buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin: 25px 0;
        }
        button {
            font-family: "楷体", KaiTi, "STKaiti", serif;
            padding: 8px 16px;
            background-color: #4a5568;
            border: 1px solid #718096;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 15px;
            color: #e2e8f0;
        }
        button:hover {
            background-color: #718096;
            transform: translateY(-2px);
        }
        button.active {
            background-color: #fbd38d;
            color: #1a202c;
            border-color: #fbd38d;
        }
        #annotationContent {
            background-color: #2d3748;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #4a5568;
        }
        .annotation-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #fbd38d;
            font-size: 18px;
            border-bottom: 1px solid #4a5568;
            padding-bottom: 8px;
        }
        .original-text {
            white-space: pre-wrap;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px dashed #4a5568;
            color: #e2e8f0;
        }
        .plain-text {
            background-color: #4a5568;
            padding: 15px;
            border-radius: 5px;
            line-height: 1.7;
            color: #e2e8f0;
            border-left: 3px solid #fbd38d;
        }
        .plain-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #fbd38d;
        }
        #annotationContent > div:first-child {
            text-align: center;
            color: #a0aec0;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>子曰：「道千乘之國，敬事而信，節用而愛人，使民以時。」</h1>
    
    <div class="main-text">
        <span class="char-container">
            <span>子</span>
            <span class="char-pinyin">zǐ</span>
            <span class="char-english">Master</span>
        </span>
        <span class="char-container">
            <span>曰</span>
            <span class="char-pinyin">yuē</span>
            <span class="char-english">said</span>
        </span>
        <span class="char-container">
            <span>：</span>
        </span>
        <span class="char-container">
            <span>「</span>
        </span>
        <span class="char-container">
            <span>道</span>
            <span class="char-pinyin">dǎo</span>
            <span class="char-english">govern</span>
        </span>
        <span class="char-container">
            <span>千</span>
            <span class="char-pinyin">qiān</span>
            <span class="char-english">thousand</span>
        </span>
        <span class="char-container">
            <span>乘</span>
            <span class="char-pinyin">shèng</span>
            <span class="char-english">chariots</span>
        </span>
        <span class="char-container">
            <span>之</span>
            <span class="char-pinyin">zhī</span>
            <span class="char-english">'s</span>
        </span>
        <span class="char-container">
            <span>國</span>
            <span class="char-pinyin">guó</span>
            <span class="char-english">state</span>
        </span>
        <span class="char-container">
            <span>，</span>
        </span>
        <span class="char-container">
            <span>敬</span>
            <span class="char-pinyin">jìng</span>
            <span class="char-english">respect</span>
        </span>
        <span class="char-container">
            <span>事</span>
            <span class="char-pinyin">shì</span>
            <span class="char-english">affairs</span>
        </span>
        <span class="char-container">
            <span>而</span>
            <span class="char-pinyin">ér</span>
            <span class="char-english">and</span>
        </span>
        <span class="char-container">
            <span>信</span>
            <span class="char-pinyin">xìn</span>
            <span class="char-english">trust</span>
        </span>
        <span class="char-container">
            <span>，</span>
        </span>
        <span class="char-container">
            <span>節</span>
            <span class="char-pinyin">jié</span>
            <span class="char-english">economize</span>
        </span>
        <span class="char-container">
            <span>用</span>
            <span class="char-pinyin">yòng</span>
            <span class="char-english">expenditures</span>
        </span>
        <span class="char-container">
            <span>而</span>
            <span class="char-pinyin">ér</span>
            <span class="char-english">and</span>
        </span>
        <span class="char-container">
            <span>愛</span>
            <span class="char-pinyin">ài</span>
            <span class="char-english">love</span>
        </span>
        <span class="char-container">
            <span>人</span>
            <span class="char-pinyin">rén</span>
            <span class="char-english">people</span>
        </span>
        <span class="char-container">
            <span>，</span>
        </span>
        <span class="char-container">
            <span>使</span>
            <span class="char-pinyin">shǐ</span>
            <span class="char-english">employ</span>
        </span>
        <span class="char-container">
            <span>民</span>
            <span class="char-pinyin">mín</span>
            <span class="char-english">commoners</span>
        </span>
        <span class="char-container">
            <span>以</span>
            <span class="char-pinyin">yǐ</span>
            <span class="char-english">according to</span>
        </span>
        <span class="char-container">
            <span>時</span>
            <span class="char-pinyin">shí</span>
            <span class="char-english">seasons</span>
        </span>
        <span class="char-container">
            <span>。</span>
        </span>
        <span class="char-container">
            <span>」</span>
        </span>
    </div>
    
    <div class="buttons">
        <button onclick="speakChinese()">朗读全文</button>
        <button onclick="showAnnotation('考異')">考異</button>
        <button onclick="showAnnotation('考證')">考證</button>
        <button onclick="showAnnotation('集解')">集解</button>
        <button onclick="showAnnotation('唐以前古注')">唐以前古注</button>
        <button onclick="showAnnotation('集注')">集注</button>
        <button onclick="showAnnotation('餘論')">餘論</button>
        <button onclick="showAnnotation('發明')">發明</button>
    </div>
    
    <div id="annotationContent">
        <div>请点击上方按钮选择注解类别</div>
    </div>
    
    <script>
        // 朗读功能
        function speakChinese() {
            if ('speechSynthesis' in window) {
                const speech = new SpeechSynthesisUtterance();
                speech.text = "子曰：「道千乘之國，敬事而信，節用而愛人，使民以時。」";
                speech.lang = "zh-CN";
                speech.rate = 0.8;
                window.speechSynthesis.speak(speech);
            } else {
                alert("您的浏览器不支持语音合成功能，请使用现代浏览器如Chrome、Edge等。");
            }
        }
        
        // 注解内容
        const annotations = {
            '考異': {
                original: "釋文：「道」本或作「導」。\n皇本作「導」。\n宋高宗石經「敬」作「欽」，避翼祖諱。",
                plain: "《经典释文》记载：'道'字有的版本写作'导'。\n皇侃的《论语义疏》版本中写作'导'。\n宋高宗石经将'敬'写作'钦'，是为了避宋太祖赵匡胤祖父赵敬的名讳。"
            },
            '考證': {
                original: "朱子四書或問：此義疑馬氏爲可據。蓋如馬說，則八百家出車一乘；如包說，則八十家出車一乘。甲士步卒合七十五人，而牛馬兵甲糧糗芻茭具焉，恐非八十家所能給。然與孟子、王制之說不同，疑孟子未嘗盡見班爵分土之籍，特以傳聞言之，故不能無少誤。若王制則故非三代古書，其亦無足據矣。崔述三代經界通考：先儒惑於司馬法之文，以爲一乘之卒七十有二人，遂致魯頌之言先後牴牾，乃謂車計通國之賦，徒指出軍之賦以曲解之。不知司馬法乃戰國時人所撰，原不足據也。且傳又有之：衛文公元年，革車三十乘，季年乃三百乘。晉城濮之戰，全軍皆出，僅七百乘。鞌之戰，軍帥半行，乃八百乘。平邱之會，有甲車四千乘。衛地與民非能十倍其初，晉地雖闢，豈能數倍於文公之世？然則貧故車少，富故車多，不盡稱徒以造車，亦不盡計民以賦車也。晉之伐鄭也，敗其徒兵於洧上，車與徒分道以禦敵，而初不必相參，則車之多寡固不必盡準乎其徒之數，則亦不必盡準乎其民之數。惟是地廣則國富，國富則車多，故大國曰千乘，乃大略言之耳。夫安得拘拘焉以八百家或八十家出車一乘爲一成之例也？劉氏正義：案注包馬異說。皇、邢疏如文釋之，無所折衷。後人解此，乃多轇轕。從馬氏則以千乘非百里所容，從包氏則以周禮爲不可信。紛紛詰難，未定一是。近人金氏鶚求古錄說此最明最詳，故備錄之。其說云：「孟子言『天子千里，大國百里，次國七十里，小國五十里。』又言『萬乘之國，千乘之家。千乘之國，百乘之家。萬取千焉，千取百焉。』是千里出車萬乘，百里出車千乘，十里出車百乘也。子產言『天子一圻，列國一同。圻方千里，同方百里。』亦如孟子之說。以開方之法計之，方里而井，百里之國，計有萬井。萬井而出車千乘，則十井出一乘矣。若馬氏說百井出一乘，則百里之國止有百乘，必三百一十六里有奇乃有千乘，與孟子不合。包氏合於孟子，是包氏爲可據矣。哀十二年公羊傳注言：『軍賦，十井不過一乘。』此一證也。馬氏之說，則據司馬法。鄭注小司徒亦引司馬法云：『井十爲通，通三十家，爲匹馬、士一人、徒二人。通十爲成，成百井，三百家，出革車一乘、士十人、徒二十人。十成爲終，終千井，三千家，革車十乘、士百人、徒二百人。十終爲同，同方百里，萬井，三萬家，革車百乘、士千人、徒二千人。』賈疏：『通九十夫之地，宮室涂巷三分去一，又不易、一易、再易，通率三夫受六夫之地，是三十家也。』案司馬法一書，未必真周公之制，所言與孟子、子產皆不合，信司馬法何如信孟子耶？坊記云：『制國不過千乘，家富不過百乘。』今謂大夫百乘，地方百里，等于大國諸侯，必不然矣。或謂：『司馬法車乘有兩法：一云兵車一乘、士十人、徒二十人。一云兵車一乘、甲士三人、步卒七十二人。賈公彦以士十人、徒二十人爲天子畿內采地法，以甲士三人、步卒七十二人爲畿外邦國法。此言千乘之國，是畿外邦國也。一乘車士卒共七十五人，又有炊家子十人、固守衣裝五人、厩養五人、樵汲五人，共一百人。馬牛芻茭具備。此豈八十家所能給哉？』不知天子六軍出于六鄉，大國三軍出于三鄉，蓋家出一人爲兵也。又三遂亦有三軍，三鄉爲正卒，三遂爲副卒。鄉遂出軍而不出車，都鄙出車而不出兵。孔仲達成元年『丘甲』疏云：『古者天子用兵，先用六鄉。六鄉不足，取六遂。六遂不足，取都鄙及諸侯。昔諸侯出兵，先盡三鄉三遂。鄉遂不足，然後徧徵境內。』賈公彦小司徒疏亦云：『大國三軍，次國二軍，小國一軍，皆出于鄉遂。猶不止，徧境出之，是爲千乘之賦。』然則都鄙固不出兵也。江慎修云：『七十五人者，兵乘之本法。三十人者，調發之通制。魯頌「公車千乘，公徒三萬」正與司馬法合。』此說得之。然則都鄙卽至出兵，而調發之數惟用三十人，豈八十家所不能給哉？至於丘乘之法，八十家而具七十五人，無過家一人耳，此但備而不用，惟蒐田講武乃行，又何不給之有？農隙講武，正當人人訓練，家出一人，不爲厲民也。若夫車馬之費，亦自不多。古者材木取之公家。山林而無禁，則造車不難。馬牛畜之民間，可給民用，不過暫出以供蒐田之用耳。芻茭則尤野人所易得者也。且以八十家而出一車四馬，又何患其不給乎？或又謂：『百里之國，山川林麓城郭宮室涂巷園囿三分去一，三鄉三遂又不出車，又不易、一易、再易，通率三夫受六夫之地，則三百乘且不足，安得有千乘乎？』不知百里之國以出稅之田言，非以封域言也。孟子言頒禄，正是言田。其曰地方百里者，地與田通稱，故井地卽井田也。百里以田言，則山川林麓以及涂巷園囿等固已除去矣。頒禄必均，若不去山川，山川天下不同，則禄不均矣。苟境內山川甚多，而封域止百里，田稅所出，安足以給用乎？故知大國百里，其封疆必不止此。周禮所以有五百里四百里之說，蓋兼山川附庸而言也。孟子則專言榖土耳。城郭宮室涂巷等雖有定數，然亦非榖土，則亦不在百里之內也。先儒三分去一之說，亦未必然。孟子言方里而井，百里七十里五十里皆以井計數。方里不必其形正方，以方田之法算之，有九百畝則曰方里。地方百里等方字皆如是也。然則百里之國不謂封疆，其里亦非廣長之里矣。孟子言一夫百畝，而周禮有不易百畝，一易二百畝，再易三百畝之說，蓋孟子言其略，周禮則詳言之也。分田必均，周禮以三等均之，其說至當。左傳：『井衍沃，牧隰臯。』鄭氏謂『隰臯九夫爲牧，二牧而當一井』是也。是則一井不必九百畝，百里之國亦不必九百萬畝，以通率二井當一井，當有一千八百萬畝矣。孟子但舉不易之田，故曰『一夫百畝，大國百里』也。鄉遂之民皆受田，則亦有車乘，但其作之之財受于官府，故曰不出車，非無車也。夫如是，百里之國豈不足於千乘哉？包氏之說，可無疑矣。」物茂卿，論語徵：萬乘、千乘、百乘，古言也。謂天子爲萬乘，諸侯爲千乘，大夫爲百乘，語其富也。如千金之子，孰能計其囊之藏適若干而言之乎？古來注家布算求合，可謂「不解事子雲」矣。\n按：論語徵十卷，日本物茂卿撰。議論通達，多可採者，惟中土少傳本。俞樾春在堂隨筆錄十餘條，大旨好與宋儒牴牾。茲擇其議論純正者錄而存之。\n方觀旭論語偶記：【集解】云：「融依周禮，包依王制、孟子，義疑，故兩存焉。」近時經師從馬氏。竊以泰伯篇曾子曰「可以寄百里之命」，謂攝國君之政令。先進篇冉有曰「方六七十如五六十」，謙不敢當千乘之國。則千乘之國爲百里甚明，以他經解論語，何如以論語證論語？\n按：如方氏之說，千乘之爲百里，毫無可疑。周禮僞書，不足據也。\n俞樾湖樓筆談：千乘之國，馬包異說，當以包說爲長。子路曰「千乘之國」，冉求曰「方六七十如五六十」，蓋子路所說者，百里之國，故冉求從而遞減之，爲六七十五六十也。若從馬說，千乘之賦其地千成，居地方三百一十六里，似過大矣。大約古人言百里之國使爲大國，故曰「可以託六尺之孤，可以寄百里之命。」六尺以極小言，百里以極大言。不極小不足見託孤之難，不極大不足見寄命之難。後人生大一統之世，提封萬里，遂覺百里之地小若彈丸，此古今之勢異也。鄭浩論語集注述要：千乘有二說：馬注一成八百家出一乘，千乘爲方三百一十六里。包注十井八十家出一乘，千乘適爲百里之地。朱子前嘗是馬說，及爲集注，又不實指，僅曰「其地可出兵車千乘」，豈因二者皆難知其孰確，不欲多費力於無用之地乎？以下凡名物度數無關本文要旨，紛議莫能確定者準此。",
                plain: "这部分详细考证了关于'千乘之国'的不同解释：\n1. 朱熹在《四书或问》中认为马融的说法更可信，即八百家出一乘\n2. 崔述在《三代经界通考》中批评前人过分拘泥于《司马法》的计算方法\n3. 刘宝楠《论语正义》详细比较了马融和包咸两种说法\n4. 金鹗《求古录》通过详细计算支持包咸的说法（百里之国出千乘）\n5. 日本学者物茂卿认为'千乘'只是形容国家富强的概数\n6. 方观旭通过《论语》内证支持包咸的说法\n7. 俞樾从古今差异角度解释百里之国在古代已算大国\n8. 郑浩指出朱熹在《集注》中故意回避了这个问题"
            },
            '集解': {
                original: "馬曰：「道，謂爲之政教也。司馬法『六尺爲步，步百爲畝，畝百爲夫，夫三爲屋，屋三爲井，井十爲通，通十爲成，成出革車一乘。』然則千乘之賦其地千成，居地方三百一十六里有畸，惟公侯之封乃能容之，雖大國之賦亦不是過焉。」包曰：「道，治也。千乘之國者，百里之國也。古者井田，方里爲井，十井爲乘，百里之國，適千乘也。」融依周禮，包依王制、孟子，義疑，故兩存焉。包曰：「爲國者舉事必敬慎，與民必誠信也。節用者，不奢侈也。國以民爲本，故愛養之也。作事使民，必以其時，不妨奪農務也。」",
                plain: "马融注：'道'指施行政教。根据《司马法》计算，千乘之国需要方圆三百一十六里，只有公侯的封地才能容纳。\n包咸注：'道'是治理的意思。千乘之国就是方圆百里的国家。按照古代井田制计算，百里之国正好出千乘兵车。\n编者按：马融依据《周礼》，包咸依据《王制》和《孟子》，因两种说法都有疑问，所以并存。\n包咸进一步解释：治理国家要恭敬谨慎地处理政事，对民众要诚信。节约用度不奢侈。国家以民众为根本，所以要爱护养育。使用民力要选择适当时间，不妨碍农事。"
            },
            '唐以前古注': {
                original: "詩•小雅•信南山正義引鄭注司馬法云：井十爲通，通十爲成，成方十里，出革車一乘。周禮•小司徒疏引鄭注：甲士三人，步卒七十二人。皇疏：千乘，大國也。天子萬乘，諸侯千乘。千乘尚式，則萬乘可知也。此以下皆導千乘之國法也。爲人君者，事無小大悉須敬，故云「敬事」也。曲禮云「毋不敬」是也。又與民必信，故云「信」也。雖富有一國之財，而不可奢侈，故云「節用」也。雖貴居民上，不可驕慢，故云「愛人」也。使民，謂治城及道路也。以時，謂出不過三日，而不妨奪民農務也。然人是有識之目，愛人則兼朝廷也。民是瞑闇之稱，使之則唯指黔黎也。",
                plain: "郑玄注《司马法》：十井为一通，十通为一成，一成方圆十里，出一辆兵车。\n郑玄注《周礼•小司徒》：每乘兵车配备甲士三人，步卒七十二人。\n皇侃疏：千乘是大国。天子万乘，诸侯千乘。这里讲的是治理大国的法则。\n作为君主，处理政事无论大小都要恭敬（'敬事'）。\n对民众要讲信用（'信'）。\n虽然拥有国家财富但不能奢侈（'节用'）。\n虽然地位尊贵但不能傲慢（'爱人'）。\n'使民'指修筑城池道路等劳役。\n'以时'指服役不超过三天，不妨碍农事。\n'人'包括有见识的官员，'民'则专指普通百姓。"
            },
            '集注': {
                original: "道，治也。千乘，諸侯之國，其地可出兵車千乘者也。敬者，主一無適之謂。敬事而信者，敬其事而信於民也。時，謂農隙之時。言治國之要，在此五者，亦務本之意也。",
                plain: "朱熹注：\n'道'是治理的意思。\n'千乘之国'指能出兵车千乘的诸侯国。\n'敬'是专注不放逸的意思。\n'敬事而信'指认真处理政事并取信于民。\n'时'指农闲时节。\n治理国家的要领就在这五点，这也是重视根本的体现。"
            },
            '餘論': {
                original: "四書賸言：王制：「用民之力，歲不過三日。」而周官•均人又以豐凶較公旬之政，豐年三日，中年二日，無年一日。此云「使民」，不止公旬，有卽以農事使民者。如「三日于耜，四日舉趾」，則使民耕植之時。「九月築塲圃，十月納禾稼」，則使民刈穫之時。「龍見而畢務，火見而致用」，則使民興築之時。「仲夏斬陽木，仲冬斬陰木」，則使民樵棌之時。「十一月徒杠成，十二月輿梁成」，則使民謹出入修橋道之時。故春秋傳曰「凡啟塞從時」，謂凡事之啟塞皆當從其時也。黄氏後案：陸稼書說：「敬是遇事謹慎之意，不必言包括眾善。信者不用權詐，不朝更夕改，惟此真確之誠，表裏如一，始終如一。雖事勢之窮，亦濟以變，而守常之時多，濟變之時少也。節用不必說，節非褊嗇，而當節者，務欲返一國奢靡之習而同歸於淳樸。愛人不必說，愛非姑息，而當愛者，務欲合一國臣民之衆而共遊於蕩平也。」式三案後儒標示心學，說敬太過，失之。於此章尤不合。信與節愛，近解亦過求深。尋繹經旨，陸氏說是。楊注云「未及爲政」，未可據。敬信節愛時使自有實功實效，以發所存之正。朱子與張敬夫書曰：「徒言正心而不足以識事物之要，是腐儒迂闊之論，不足與論當世之務。」然則論治未有專言所存者，朱子蓋節取其論所存而錄之歟？朱子作集注，意在詳錄宋儒之說。而說之未醇者亦存之，意在節取也。讀注者或誤衍之，或以此攻朱子矣。東塾讀書記：道千乘之國章，朱注采程子曰：「此言至淺。然當時諸侯果能此，亦足以治其國矣。」此於聖人之言頗有不滿之意，似不必采之。\n按：宋儒中如伊川之迂腐，龜山之庸懦，當時皆負有盛名，則以朱子標榜之力爲多，讀【集注】者當分別觀之。",
                plain: "《四书剩言》指出：'使民'不仅包括官方规定的劳役（'公旬'），还包括各种农事活动。\n《黄氏后案》引陆稼书观点：\n'敬'就是谨慎处事，不必过度解释。\n'信'就是不用权谋欺诈，保持一贯。\n'节用'是纠正奢侈风气回归淳朴。\n'爱人'是团结所有臣民共享太平。\n编者按：后世儒家过分强调心性修养，对此章的解释多有偏差。朱熹《集注》收录各家之说，读者应当辨别取舍。\n《东塾读书记》批评朱熹收录程颐对孔子言论不够尊重的评语。\n按语指出：程颐、杨时等宋儒的学说因朱熹推崇而影响很大，但读者应当批判性地看待。"
            },
            '發明': {
                original: "焦氏筆乘：「敢問事業如何？」仲脩曰：「事業正自爲學中來。只如作一郡，行得論語中三句便用之不盡。」彦平曰：「願聞之。」仲脩曰：「『敬事而信，節用而愛人，使民以時』是也。」彦平佩服其言，每曰：「吾平生操心行己，立朝事君，皆趙君之言有以發之。」四書讀（四書辨證引）：不曰治而曰道者何？治者，法術之名。道者，仁義之用也。若千乘固是舉以爲例。第夫子時，上而周室不能有爲，下而小國不足有爲，惟大國可以自奮。然不曰大國而卽兵車言者，蓋當時大國惟利是務，其於敬信五者闕焉弗講，夫子蓋有爲而言也。",
                plain: "《焦氏笔乘》记载：赵仲修认为只要实践'敬事而信，节用而爱人，使民以时'这三句话，就足以治理好一个郡。\n《四书读》指出：\n用'道'而不用'治'字，因为'道'强调仁义的根本。\n孔子特别针对当时大国只追求利益而忽视这些基本原则的情况。\n通过谈论兵车数量来提醒大国重视根本的治国之道。"
            }
        };
        
        // 当前选中的注解类型
        let currentAnnotation = null;
        
        // 显示注解功能
        function showAnnotation(type) {
            if (!annotations[type]) return;
            
            currentAnnotation = type;
            
            // 更新按钮状态
            document.querySelectorAll('.buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // 构建注解内容
            let content = `
                <div class="annotation-title">【${type}】</div>
                <div class="original-text">${annotations[type].original}</div>
                <div class="plain-title">白话文翻译：</div>
                <div class="plain-text">${annotations[type].plain}</div>
                <div style="text-align: right; margin-top: 15px;">
                    <button onclick="speakAnnotation()" style="padding: 5px 12px; font-size: 14px;">
                        语音讲解
                    </button>
                </div>
            `;
            
            document.getElementById("annotationContent").innerHTML = content;
        }
        
        // 朗读注解（先读原文句子，再读对应翻译）
        function speakAnnotation() {
            if (!currentAnnotation || !annotations[currentAnnotation]) {
                alert("请先选择注解内容");
                return;
            }
            
            if (!window.speechSynthesis) {
                alert("您的浏览器不支持语音合成功能");
                return;
            }
            
            // 停止当前所有语音
            window.speechSynthesis.cancel();
            
            const originalText = annotations[currentAnnotation].original;
            const plainText = annotations[currentAnnotation].plain;
            
            // 分割原文为句子
            const sentences = originalText.split(/([。！？\n])/).reduce((acc, val, i, arr) => {
                if (i % 2 === 0) {
                    const pair = val + (arr[i+1] || '');
                    if (pair.trim()) acc.push(pair.trim());
                }
                return acc;
            }, []);
            
            // 分割白话文为对应解释
            const plainParts = plainText.split('\n').filter(p => p.trim());
            
            // 逐个朗读原文句子和对应解释
            let index = 0;
            
            function speakNext() {
                if (index < sentences.length) {
                    // 朗读原文句子
                    const speech1 = new SpeechSynthesisUtterance();
                    speech1.text = sentences[index];
                    speech1.lang = "zh-CN";
                    speech1.rate = 0.7;
                    
                    // 朗读对应的白话解释
                    const speech2 = new SpeechSynthesisUtterance();
                    speech2.text = index < plainParts.length ? plainParts[index] : "";
                    speech2.lang = "zh-CN";
                    speech2.rate = 0.8;
                    
                    // 先读原文，读完后再读解释
                    speech1.onend = function() {
                        if (speech2.text) {
                            window.speechSynthesis.speak(speech2);
                            speech2.onend = function() {
                                index++;
                                setTimeout(speakNext, 300);
                            };
                        } else {
                            index++;
                            setTimeout(speakNext, 300);
                        }
                    };
                    
                    window.speechSynthesis.speak(speech1);
                }
            }
            
            speakNext();
        }
        
        // 为每个汉字添加点击显示拼音/英文功能
        document.querySelectorAll('.char-container').forEach(container => {
            const pinyin = container.querySelector('.char-pinyin');
            const english = container.querySelector('.char-english');
            let clickCount = 0;
            
            if (!pinyin && !english) return;
            
            container.addEventListener('click', (e) => {
                e.stopPropagation();
                
                clickCount++;
                
                // 隐藏所有提示
                document.querySelectorAll('.char-pinyin, .char-english').forEach(p => {
                    p.style.display = 'none';
                });
                
                // 第一次点击显示拼音，第二次显示英文
                if (clickCount % 2 === 1 && pinyin) {
                    pinyin.style.display = 'block';
                } else if (english) {
                    english.style.display = 'block';
                }
                
                // 3秒后自动隐藏
                setTimeout(() => {
                    if (pinyin) pinyin.style.display = 'none';
                    if (english) english.style.display = 'none';
                }, 3000);
            });
        });
        
        // 点击页面其他地方隐藏所有提示
        document.addEventListener('click', () => {
            document.querySelectorAll('.char-pinyin, .char-english').forEach(p => {
                p.style.display = 'none';
            });
        });
    </script>
</body>
</html>