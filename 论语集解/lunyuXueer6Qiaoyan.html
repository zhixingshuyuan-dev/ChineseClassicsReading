<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>论语解读 - 巧言令色</title>
    <style>
        body {
            font-family: "楷体", KaiTi, "STKaiti", serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #e2e8f0;
            background-color: #1a202c;
        }
        h1 {
            font-family: "黑体", SimHei, sans-serif;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 30px;
            color: #fbd38d;
        }
        .main-text {
            font-size: 22px;
            text-align: center;
            margin: 40px 0;
            line-height: 2;
            padding: 20px;
            background-color: #2d3748;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #4a5568;
        }
        .char-container {
            display: inline-block;
            cursor: pointer;
            margin: 0 1px;
            position: relative;
            vertical-align: top;
        }
        .char-pinyin {
            display: none;
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #fbd38d;
            color: #1a202c;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .char-pinyin:after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 5px 5px 0;
            border-style: solid;
            border-color: #fbd38d transparent transparent;
        }
        .buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin: 25px 0;
        }
        button {
            font-family: "楷体", KaiTi, "STKaiti", serif;
            padding: 8px 16px;
            background-color: #4a5568;
            border: 1px solid #718096;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 15px;
            color: #e2e8f0;
        }
        button:hover {
            background-color: #718096;
            transform: translateY(-2px);
        }
        button.active {
            background-color: #fbd38d;
            color: #1a202c;
            border-color: #fbd38d;
        }
        #annotationContent {
            background-color: #2d3748;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #4a5568;
        }
        .annotation-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #fbd38d;
            font-size: 18px;
            border-bottom: 1px solid #4a5568;
            padding-bottom: 8px;
        }
        .original-text {
            white-space: pre-wrap;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px dashed #4a5568;
            color: #e2e8f0;
        }
        .plain-text {
            background-color: #4a5568;
            padding: 15px;
            border-radius: 5px;
            line-height: 1.7;
            color: #e2e8f0;
            border-left: 3px solid #fbd38d;
        }
        .plain-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #fbd38d;
        }
        #annotationContent > div:first-child {
            text-align: center;
            color: #a0aec0;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>子曰：「巧言令色，鮮矣仁！」</h1>
    
    <div class="main-text">
        <span class="char-container">
            <span>子</span>
            <span class="char-pinyin">zǐ</span>
        </span>
        <span class="char-container">
            <span>曰</span>
            <span class="char-pinyin">yuē</span>
        </span>
        <span class="char-container">
            <span>：</span>
        </span>
        <span class="char-container">
            <span>「</span>
        </span>
        <span class="char-container">
            <span>巧</span>
            <span class="char-pinyin">qiǎo</span>
        </span>
        <span class="char-container">
            <span>言</span>
            <span class="char-pinyin">yán</span>
        </span>
        <span class="char-container">
            <span>令</span>
            <span class="char-pinyin">lìng</span>
        </span>
        <span class="char-container">
            <span>色</span>
            <span class="char-pinyin">sè</span>
        </span>
        <span class="char-container">
            <span>，</span>
        </span>
        <span class="char-container">
            <span>鮮</span>
            <span class="char-pinyin">xiān</span>
        </span>
        <span class="char-container">
            <span>矣</span>
            <span class="char-pinyin">yǐ</span>
        </span>
        <span class="char-container">
            <span>仁</span>
            <span class="char-pinyin">rén</span>
        </span>
        <span class="char-container">
            <span>！</span>
        </span>
        <span class="char-container">
            <span>」</span>
        </span>
    </div>
    
    <div class="buttons">
        <button onclick="speakChinese()">朗读全文</button>
        <button onclick="showAnnotation('考異')">考異</button>
        <button onclick="showAnnotation('考證')">考證</button>
        <button onclick="showAnnotation('集解')">集解</button>
        <button onclick="showAnnotation('唐以前古注')">唐以前古注</button>
        <button onclick="showAnnotation('集注')">集注</button>
        <button onclick="showAnnotation('餘論')">餘論</button>
        <button onclick="showAnnotation('發明')">發明</button>
    </div>
    
    <div id="annotationContent">
        <div>请点击上方按钮选择注解类别</div>
    </div>
    
    <script>
        // 朗读功能
        function speakChinese() {
            if ('speechSynthesis' in window) {
                const speech = new SpeechSynthesisUtterance();
                speech.text = "子曰：「巧言令色，鮮矣仁！」";
                speech.lang = "zh-CN";
                speech.rate = 0.8;
                window.speechSynthesis.speak(speech);
            } else {
                alert("您的浏览器不支持语音合成功能，请使用现代浏览器如Chrome、Edge等。");
            }
        }
        
        // 注解内容
        const annotations = {
            '考異': {
                original: "皇本作「鮮矣有仁」。",
                plain: "皇侃的《论语义疏》版本中写作'鲜矣有仁'，比通行本多'有'字。"
            },
            '考證': {
                original: "大戴禮•曾子立事篇：巧言令色，難於仁矣。\n禮記•仲尼燕居篇「給奪慈仁」，鄭注：「巧言足恭之人似慈仁。」\n潘氏集箋：孫星衍尚書今古文疏以「何畏乎巧言令色」爲「不仁者遠」，蓋本此。",
                plain: "《大戴礼记•曾子立事篇》记载：'巧言令色，难于仁矣。'\n《礼记•仲尼燕居篇》'给夺慈仁'，郑玄注：'巧言足恭之人似慈仁。'\n潘维城《论语集笺》指出孙星衍《尚书今古文注疏》中'何畏乎巧言令色'解释为'不仁者远'，应源于此。"
            },
            '集解': {
                original: "包曰：「巧言，好其言語。令色，善其顏色。皆欲令人說之，少能有仁也。」",
                plain: "包咸注：'巧言'指修饰言辞使其动听，'令色'指装扮表情使其和善。这些都是为了取悦他人，很少能真正具备仁德。"
            },
            '唐以前古注': {
                original: "皇疏引張憑云：仁者，人之性也。性有厚薄，故體足者難耳。巧言令色之人於仁性爲少，非爲都無其分也，故曰鮮矣有仁。\n按：憑字長宗，吳人。官至司徒左長史。晉書有傳。",
                plain: "皇侃《论语义疏》引张凭说：仁是人的本性，但本性有厚薄之分。巧言令色之人仁性较少，并非完全没有，所以说'鲜矣有仁'。\n按：张凭字长宗，吴地人，官至司徒左长史，《晋书》有传。"
            },
            '集注': {
                original: "巧，好。令，善也。好其言，善其色，致飾於外，務以說人，則人欲肆而本心之德亡矣。聖人辭不迫切，專言鮮則絕無可知，學者所當深戒也。",
                plain: "朱熹注：'巧'是好，'令'是善。修饰言辞，装扮表情，过分注重外表来取悦他人，就会放纵人欲而丧失本心之德。孔子用词不绝对，说'鲜'而不说'绝无'，学者应当深以为戒。"
            },
            '餘論': {
                original: "四書辨疑：致飾於外，言甚有理。必有陰機在內，而後致飾於外，將有陷害，使之不爲隄防也。",
                plain: "《四书辨疑》指出：外表过分修饰的人，往往内心藏有阴谋。他们精心修饰外表，是为了让人不加防备而实施陷害。"
            },
            '發明': {
                original: "日知錄：天下不仁之人有二：一爲好犯上好作亂之人，一爲巧言令色之人。",
                plain: "《日知录》认为：天下不仁之人有两种：一是犯上作乱之人，二是巧言令色之人。"
            }
        };
        
        // 当前选中的注解类型
        let currentAnnotation = null;
        
        // 显示注解功能
        function showAnnotation(type) {
            if (!annotations[type]) return;
            
            currentAnnotation = type;
            
            // 更新按钮状态
            document.querySelectorAll('.buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // 构建注解内容
            let content = `
                <div class="annotation-title">【${type}】</div>
                <div class="original-text">${annotations[type].original}</div>
                <div class="plain-title">白话文翻译：</div>
                <div class="plain-text">${annotations[type].plain}</div>
                <div style="text-align: right; margin-top: 15px;">
                    <button onclick="speakAnnotation()" style="padding: 5px 12px; font-size: 14px;">
                        语音讲解
                    </button>
                </div>
            `;
            
            document.getElementById("annotationContent").innerHTML = content;
        }
        
        // 朗读注解（先读原文，再读翻译）
        function speakAnnotation() {
            if (!currentAnnotation || !annotations[currentAnnotation]) {
                alert("请先选择注解内容");
                return;
            }
            
            if (!window.speechSynthesis) {
                alert("您的浏览器不支持语音合成功能");
                return;
            }
            
            // 停止当前所有语音
            window.speechSynthesis.cancel();
            
            const originalText = annotations[currentAnnotation].original;
            const plainText = annotations[currentAnnotation].plain;
            
            // 分割原文为句子
            const sentences = originalText.split(/([。！？\n])/).reduce((acc, val, i, arr) => {
                if (i % 2 === 0) {
                    const pair = val + (arr[i+1] || '');
                    if (pair.trim()) acc.push(pair.trim());
                }
                return acc;
            }, []);
            
            // 分割白话文为对应解释
            const plainParts = plainText.split('\n').filter(p => p.trim());
            
            // 逐个朗读原文句子和对应解释
            let index = 0;
            
            function speakNext() {
                if (index < sentences.length) {
                    // 朗读原文句子
                    const speech1 = new SpeechSynthesisUtterance();
                    speech1.text = sentences[index];
                    speech1.lang = "zh-CN";
                    speech1.rate = 0.7;
                    
                    // 朗读对应的白话解释
                    const speech2 = new SpeechSynthesisUtterance();
                    speech2.text = index < plainParts.length ? plainParts[index] : "";
                    speech2.lang = "zh-CN";
                    speech2.rate = 0.8;
                    
                    // 先读原文，读完后再读解释
                    speech1.onend = function() {
                        if (speech2.text) {
                            window.speechSynthesis.speak(speech2);
                            speech2.onend = function() {
                                index++;
                                setTimeout(speakNext, 300);
                            };
                        } else {
                            index++;
                            setTimeout(speakNext, 300);
                        }
                    };
                    
                    window.speechSynthesis.speak(speech1);
                }
            }
            
            speakNext();
        }
        
        // 为每个汉字添加点击显示拼音功能
        document.querySelectorAll('.char-container').forEach(container => {
            const pinyin = container.querySelector('.char-pinyin');
            if (!pinyin || !pinyin.textContent) return;
            
            container.addEventListener('click', (e) => {
                e.stopPropagation();
                
                // 隐藏所有拼音
                document.querySelectorAll('.char-pinyin').forEach(p => {
                    p.style.display = 'none';
                });
                
                // 显示当前拼音
                pinyin.style.display = 'block';
                
                // 2秒后自动隐藏
                setTimeout(() => {
                    pinyin.style.display = 'none';
                }, 2000);
            });
        });
        
        // 点击页面其他地方隐藏所有拼音
        document.addEventListener('click', () => {
            document.querySelectorAll('.char-pinyin').forEach(p => {
                p.style.display = 'none';
            });
        });
    </script>
</body>
</html>