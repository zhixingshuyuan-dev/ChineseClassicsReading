<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã€Šè¥¿æ¸¸è®°ã€‹è¾…åŠ©é˜…è¯»å™¨</title>
  <style>
    body {
      font-family: 'Noto Serif SC', serif;
      background-color: #f9f9f9;
      color: #333;
      margin: 0;
      padding: 1em;
      line-height: 1.8;
    }
    .line {
      margin-bottom: 1.5em;
      font-size: 1.2em;
    }
    .char {
      cursor: pointer;
      padding: 0.2em;
      border-radius: 0.3em;
      transition: background 0.3s;
    }
    .char:hover {
      background-color: #eee;
    }
    .annotation {
      display: block;
      font-size: 0.9em;
      color: #666;
    }
    .controls {
      margin-top: 0.5em;
    }
    button {
      margin-right: 0.5em;
      padding: 0.4em 0.8em;
      font-size: 0.9em;
      border: none;
      border-radius: 0.4em;
      background-color: #007BFF;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    @media (max-width: 600px) {
      body {
        font-size: 1em;
        padding: 0.5em;
      }
      .controls button {
        display: block;
        margin-top: 0.4em;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>ã€Šè¥¿æ¸¸è®°ã€‹ç¬¬å››å› è¾…åŠ©é˜…è¯»</h1>
  <div id="content"></div>

  <script>
    const data = `é‚£å¤ªç™½é‡‘æ˜Ÿä¸ç¾çŒ´ç‹ åŒå‡ºäº†æ´å¤©æ·±å¤„ ä¸€é½é©¾äº‘è€Œèµ· åŸæ¥æ‚Ÿç©ºç­‹æ–—äº‘æ¯”ä¼—ä¸åŒ ååˆ†å¿«ç–¾ æŠŠä¸ªé‡‘æ˜Ÿæ’‡åœ¨è„‘å å…ˆè‡³å—å¤©é—¨å¤– æ­£æ¬²æ”¶äº‘å‰è¿› è¢«å¢é•¿å¤©ç‹é¢†ç€åºåˆ˜è‹Ÿæ¯•é‚“è¾›å¼ é™¶ ä¸€è·¯å¤§åŠ›å¤©ä¸ æªåˆ€å‰‘æˆŸ æŒ¡ä½å¤©é—¨ ä¸è‚¯æ”¾è¿› çŒ´ç‹é“ è¿™ä¸ªé‡‘æ˜Ÿè€å„¿ ä¹ƒå¥¸è¯ˆä¹‹å¾’ æ—¢è¯·è€å­™ å¦‚ä½•æ•™äººåŠ¨åˆ€åŠ¨æª é˜»å¡é—¨è·¯ æ­£åš·é—´ é‡‘æ˜Ÿå€åˆ° æ‚Ÿç©ºå°±è§Œé¢å‘ç‹ é“ ä½ è¿™è€å„¿ æ€ä¹ˆå“„æˆ‘ è¢«ä½ è¯´å¥‰ç‰å¸æ‹›å®‰æ—¨æ„æ¥è¯· å´æ€ä¹ˆæ•™è¿™äº›äººé˜»ä½å¤©é—¨ ä¸æ”¾è€å­™è¿›å» é‡‘æ˜Ÿç¬‘é“ å¤§ç‹æ¯æ€’ ä½ è‡ªæ¥æœªæ›¾åˆ°æ­¤å¤©å ‚ å´åˆæ— å ä¼—å¤©ä¸åˆä¸ä½ ç´ ä¸ç›¸è¯† ä»–æ€è‚¯æ”¾ä½ æ“…å…¥ ç­‰å¦‚ä»Šè§äº†å¤©å°Š æˆäº†ä»™å½• æ³¨äº†å®˜å å‘åéšä½ å‡ºå…¥ è°å¤æŒ¡ä¹Ÿ æ‚Ÿç©ºé“ è¿™ç­‰è¯´ ä¹Ÿç½¢ æˆ‘ä¸è¿›å»äº† é‡‘æ˜Ÿåˆç”¨æ‰‹æ‰¯ä½é“ ä½ è¿˜åŒæˆ‘è¿›å»`;

    const pinyinMap = {
      "å¤ª": "tÃ i", "ç™½": "bÃ¡i", "é‡‘": "jÄ«n", "æ˜Ÿ": "xÄ«ng", "æ‚Ÿ": "wÃ¹", "ç©º": "kÅng",
      "ç­‹": "jÄ«n", "æ–—": "dÇ’u", "äº‘": "yÃºn", "å—": "nÃ¡n", "å¤©": "tiÄn", "é—¨": "mÃ©n",
      "çŒ´": "hÃ³u", "ç‹": "wÃ¡ng", "é“": "dÃ o", "ä½ ": "nÇ", "æˆ‘": "wÇ’", "ä¸": "bÃ¹",
      "è¿›": "jÃ¬n", "å»": "qÃ¹", "è¯·": "qÇng", "è€": "lÇo", "å­™": "sÅ«n", "å": "mÃ­ng",
      // ... æ·»åŠ æ›´å¤šæ‹¼éŸ³æ•°æ®
    };

    const englishMap = {
      "å¤ª": "great", "ç™½": "white", "é‡‘": "gold", "æ˜Ÿ": "star", "æ‚Ÿ": "awaken", "ç©º": "emptiness",
      "ç­‹": "muscle", "æ–—": "fight", "äº‘": "cloud", "å—": "south", "å¤©": "heaven", "é—¨": "gate",
      "çŒ´": "monkey", "ç‹": "king", "é“": "say", "ä½ ": "you", "æˆ‘": "I/me", "ä¸": "not",
      "è¿›": "enter", "å»": "go", "è¯·": "invite", "è€": "old", "å­™": "Sun (name)", "å": "name",
      // ... æ·»åŠ æ›´å¤šè‹±æ–‡é‡Šä¹‰
    };

    const translations = {
      en: "English", de: "Deutsch", fr: "FranÃ§ais", ja: "æ—¥æœ¬èª", ko: "í•œêµ­ì–´", vi: "Tiáº¿ng Viá»‡t",
      it: "Italiano", es: "EspaÃ±ol", pt: "PortuguÃªs", la: "Latina", el: "Î•Î»Î»Î·Î½Î¹ÎºÎ¬", sa: "à¤¸à¤‚à¤¸à¥à¤•à¥ƒà¤¤à¤®à¥"
    };

    const contentEl = document.getElementById('content');
    let clickState = {};

    function renderText(text) {
      const lines = text.split(/(?<=\s)/);
      lines.forEach(line => {
        const div = document.createElement('div');
        div.className = 'line';
        line.split('').forEach(char => {
          if (char.trim()) {
            const span = document.createElement('span');
            span.className = 'char';
            span.textContent = char;
            span.dataset.char = char;
            span.dataset.state = 0;
            span.addEventListener('click', handleCharClick);
            div.appendChild(span);
          } else {
            div.appendChild(document.createTextNode(' '));
          }
        });
        const controls = document.createElement('div');
        controls.className = 'controls';
        const speakBtn = document.createElement('button');
        speakBtn.textContent = 'ğŸ”Š æœ—è¯» / Read';
        speakBtn.onclick = () => speak(line);
        controls.appendChild(speakBtn);

        const translateBtn = document.createElement('button');
        translateBtn.textContent = 'ğŸŒ ç¿»è¯‘ / Translate';
        translateBtn.onclick = () => translateLine(line);
        controls.appendChild(translateBtn);

        div.appendChild(controls);
        contentEl.appendChild(div);
      });
    }

    function handleCharClick(e) {
      const span = e.target;
      const char = span.dataset.char;
      let state = parseInt(span.dataset.state);
      state = (state + 1) % 3;
      span.dataset.state = state;

      if (state === 1) {
        span.innerHTML = `${char}<span class="annotation">${pinyinMap[char] || ''}</span>`;
      } else if (state === 2) {
        speak(char);
      } else {
        span.innerHTML = `${char}<span class="annotation">${englishMap[char] || ''}</span>`;
      }
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'zh-CN';
      utterance.voice = speechSynthesis.getVoices().find(v => v.lang === 'zh-CN' && v.name.includes('ç”·')) || null;
      speechSynthesis.speak(utterance);
    }

    async function translateLine(text) {
      const apiKey = 'YOUR_API_KEY'; // éœ€è¦æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ç¿»è¯‘ API Key
      for (const [lang, label] of Object.entries(translations)) {
        const res = await fetch(`https://translation.googleapis.com/language/translate/v2?key=${apiKey}`, {
          method: 'POST',
          body: JSON.stringify({
            q: text,
            target: lang
          }),
          headers: { 'Content-Type': 'application/json' }
        });
        const json = await res.json();
        alert(`${label}ï¼š${json.data.translations[0].translatedText}`);
      }
    }

    renderText(data);
  </script>
</body>
</html>
