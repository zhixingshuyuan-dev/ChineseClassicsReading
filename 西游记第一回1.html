
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>西游记阅读器</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
      font-family: "微软雅黑", sans-serif;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    #textContainer {
      text-align: center;
      max-width: 90%;
      padding: 20px;
    }

    .sentence {
      font-size: 60px;
      line-height: 1.5;
      margin: 0 auto;
      opacity: 0;
      transition: opacity 1.5s ease-in-out;
    }

    .sentence.active {
      opacity: 1;
    }

    .hanzi {
      display: inline-block;
      min-width: 60px;
      opacity: 0;
      transform: scale(0.5);
      transition: all 0.5s ease-out;
      cursor: pointer;
      position: relative;
    }

    .hanzi.show {
      opacity: 1;
      transform: scale(1);
    }

    .hanzi.highlight {
      color: #00fff7;
      text-shadow: 0 0 10px #00fff7;
    }

    .hanzi .pinyin {
      position: absolute;
      top: -35px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 20px;
      background: rgba(0,0,0,0.7);
      padding: 2px 5px;
      border-radius: 3px;
      display: none;
    }

    .hanzi:hover .pinyin {
      display: block;
    }

    #controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
    }

    button {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid white;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }

    button:hover {
      background: rgba(255,255,255,0.3);
    }

    #startOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
    }

    #startButton {
      padding: 15px 30px;
      font-size: 24px;
      background: #00fff7;
      color: #0f2027;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.3s, background 0.3s;
    }

    #startButton:hover {
      transform: scale(1.05);
      background: #00e6d6;
    }

    #overlayText {
      margin-bottom: 30px;
      font-size: 28px;
      color: #fff;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="textContainer"></div>
  <div id="controls">
    <button id="prevBtn">上一句</button>
    <button id="pauseBtn">暂停</button>
    <button id="nextBtn">下一句</button>
  </div>

  <div id="startOverlay">
    <div id="overlayText">西游记阅读器</div>
    <button id="startButton">开始阅读</button>
  </div>

  <script>
    const sentences = [
      "这部书单讲东胜神洲的故事。",
      "海外有一个国家，名叫傲来国。",
      "这个国家靠近大海，海中有一座山，叫作花果山。",
      "这座山是十洲的祖脉，三岛的来龙，自天地开辟、清浊分离时就已存在，是鸿蒙初判后形成的。",
      "山顶正中央有一块仙石，高有三丈六尺五寸（对应周天三百六十五度），周长二丈四尺（对应二十四节气）。",
      "石上有九窍八孔，暗合九宫八卦的布局。",
      "四周没有树木遮挡，左右却有灵芝仙草相伴。",
      "自从开天辟地以来，这块石头吸收天地灵气、日月精华，久而久之，便有了灵性。",
      "有一天，仙石突然迸裂，产出一个石卵，像圆球一样大。",
      "遇到风后，石卵化作一只石猴，五官俱全，四肢齐备。"
    ];

    const pinyinMap = {
      "这": "zhè", "部": "bù", "书": "shū", "单": "dān", "讲": "jiǎng",
      "东": "dōng", "胜": "shèng", "神": "shén", "洲": "zhōu", "的": "de",
      "故": "gù", "事": "shì", "海": "hǎi", "外": "wài", "有": "yǒu",
      "一": "yī", "个": "gè", "国": "guó", "家": "jiā", "名": "míng",
      "叫": "jiào", "傲": "ào", "来": "lái", "靠": "kào", "近": "jìn",
      "大": "dà", "中": "zhōng", "座": "zuò", "山": "shān", "作": "zuò",
      "花": "huā", "果": "guǒ", "是": "shì", "十": "shí", "祖": "zǔ",
      "脉": "mài", "三": "sān", "岛": "dǎo", "龙": "lóng", "自": "zì",
      "天": "tiān", "地": "dì", "开": "kāi", "辟": "pì", "清": "qīng",
      "浊": "zhuó", "分": "fēn", "离": "lí", "时": "shí", "就": "jiù",
      "已": "yǐ", "存": "cún", "在": "zài", "鸿": "hóng", "蒙": "méng",
      "初": "chū", "判": "pàn", "后": "hòu", "形": "xíng", "成": "chéng",
      "顶": "dǐng", "正": "zhèng", "央": "yāng", "块": "kuài", "仙": "xiān",
      "石": "shí", "高": "gāo", "丈": "zhàng", "六": "liù", "尺": "chǐ",
      "五": "wǔ", "寸": "cùn", "对": "duì", "应": "yìng", "周": "zhōu",
      "度": "dù", "长": "cháng", "二": "èr", "四": "sì", "节": "jié",
      "气": "qì", "上": "shàng", "九": "jiǔ", "窍": "qiào", "八": "bā",
      "孔": "kǒng", "暗": "àn", "合": "hé", "宫": "gōng", "八": "bā",
      "卦": "guà", "布": "bù", "局": "jú", "四": "sì", "周": "zhōu",
      "没": "méi", "树": "shù", "木": "mù", "遮": "zhē", "挡": "dǎng",
      "左": "zuǒ", "右": "yòu", "却": "què", "灵": "líng", "芝": "zhī",
      "草": "cǎo", "相": "xiāng", "伴": "bàn", "从": "cóng", "以": "yǐ",
      "来": "lái", "吸": "xī", "收": "shōu", "日": "rì", "月": "yuè",
      "精": "jīng", "华": "huá", "久": "jiǔ", "而": "ér", "之": "zhī",
      "便": "biàn", "了": "le", "性": "xìng", "突": "tū", "然": "rán",
      "迸": "bèng", "裂": "liè", "产": "chǎn", "出": "chū", "卵": "luǎn",
      "像": "xiàng", "圆": "yuán", "球": "qiú", "样": "yàng", "遇": "yù",
      "风": "fēng", "化": "huà", "猴": "hóu", "五": "wǔ", "官": "guān",
      "俱": "jù", "全": "quán", "四": "sì", "肢": "zhī", "齐": "qí",
      "备": "bèi", "它": "tā", "生": "shēng", "会": "huì", "爬": "pá",
      "走": "zǒu", "还": "hái", "朝": "cháo", "着": "zhe", "拜": "bài"
    };

    // 全局变量
    let currentSentenceIndex = 0;
    let isPlaying = false;
    let timeoutId = null;
    const textContainer = document.getElementById('textContainer');
    const prevBtn = document.getElementById('prevBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const nextBtn = document.getElementById('nextBtn');
    const startButton = document.getElementById('startButton');
    const startOverlay = document.getElementById('startOverlay');
    const synth = window.speechSynthesis;

    // 初始化函数
    function init() {
      // 设置控制按钮事件
      setupControls();
      
      // 开始按钮事件
      startButton.addEventListener('click', startReading);
    }

    function setupControls() {
      prevBtn.addEventListener('click', () => {
        if (currentSentenceIndex > 0) {
          currentSentenceIndex--;
          showCurrentSentence();
        }
      });

      pauseBtn.addEventListener('click', () => {
        isPlaying = !isPlaying;
        pauseBtn.textContent = isPlaying ? '暂停' : '继续';
        if (isPlaying) {
          showCurrentSentence();
        } else {
          clearTimeout(timeoutId);
        }
      });

      nextBtn.addEventListener('click', () => {
        if (currentSentenceIndex < sentences.length - 1) {
          currentSentenceIndex++;
          showCurrentSentence();
        }
      });
    }

    function startReading() {
      startOverlay.style.display = 'none';
      isPlaying = true;
      showCurrentSentence();
      
      // 激活语音合成API（有些浏览器需要用户交互后才能使用）
      const utterance = new SpeechSynthesisUtterance('');
      utterance.volume = 0;
      synth.speak(utterance);
    }

    function speakCharacter(char) {
      if (synth.speaking) {
        synth.cancel();
      }
      
      const utterance = new SpeechSynthesisUtterance(char);
      utterance.lang = 'zh-CN';
      utterance.rate = 0.8;
      synth.speak(utterance);
    }

    function showCurrentSentence() {
      clearTimeout(timeoutId);
      
      const sentence = sentences[currentSentenceIndex];
      textContainer.innerHTML = '';
      
      const sentenceEl = document.createElement('div');
      sentenceEl.className = 'sentence';
      textContainer.appendChild(sentenceEl);
      
      // 逐个添加汉字
      const chars = sentence.split('');
      chars.forEach((char, index) => {
        const hanzi = document.createElement('span');
        hanzi.className = 'hanzi';
        hanzi.textContent = char;
        
        // 添加拼音元素
        const pinyin = document.createElement('span');
        pinyin.className = 'pinyin';
        pinyin.textContent = pinyinMap[char] || '';
        hanzi.appendChild(pinyin);
        
        // 添加点击事件
        hanzi.addEventListener('click', () => {
          speakCharacter(char);
          // 高亮效果
          document.querySelectorAll('.hanzi.highlight').forEach(el => {
            el.classList.remove('highlight');
          });
          hanzi.classList.add('highlight');
        });
        
        sentenceEl.appendChild(hanzi);
        
        // 逐个显示汉字
        setTimeout(() => {
          hanzi.classList.add('show');
        }, index * 300);
      });
      
      // 显示整句
      setTimeout(() => {
        sentenceEl.classList.add('active');
      }, 500);
      
      // 自动播放下一句
      if (isPlaying) {
        const sentenceDuration = chars.length * 300 + 3000;
        timeoutId = setTimeout(() => {
          if (currentSentenceIndex < sentences.length - 1) {
            currentSentenceIndex++;
          } else {
            currentSentenceIndex = 0; // 循环回到第一句
          }
          showCurrentSentence();
        }, sentenceDuration);
      }
    }

    // 页面加载后初始化
    window.addEventListener('load', init);
  </script>
</body>
</html>
